<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë°°ë“œë¯¼í„´ ì½”íŠ¸ ë°°ì • ì‹œìŠ¤í…œ (v3)</title>
    <style>
        /* --- ê¸°ë³¸ ìŠ¤íƒ€ì¼ --- */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f4f4f9;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            flex-direction: column;
            -webkit-font-smoothing: antialiased;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* --- ê¸€ë¡œë²Œ ì»¨íŠ¸ë¡¤ --- */
        .global-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap; /* [ìˆ˜ì •] ì°½ì´ ì¢ì•„ì§€ë©´ ì¤„ë°”ê¿ˆ */
            gap: 15px; /* [ìˆ˜ì •] ì»¨íŠ¸ë¡¤ ê°„ ê°„ê²© */
            background-color: #fff;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }

        .global-controls .control-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .global-controls label {
            font-weight: bold;
            font-size: 0.9rem;
        }

        .global-controls button, .control-group button {
            padding: 10px 15px;
            background-color: #007aff;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 0.9rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .global-controls button:hover {
            background-color: #0056b3;
        }

        .global-controls input[type="time"],
        .global-controls input[type="file"] {
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 5px 8px;
        }
        
        /* [ì‹ ê·œ] íŒŒì¼ ì—…ë¡œë“œ ë²„íŠ¼ ìˆ¨ê¸°ê¸° (ë””ìì¸ìš©) */
        .global-controls input[type="file"] {
            display: none;
        }
        
        /* [ì‹ ê·œ] íŒŒì¼ ì—…ë¡œë“œìš© ì»¤ìŠ¤í…€ ë²„íŠ¼ */
        .global-controls #csvLoadButton {
            background-color: #34c759;
        }
        .global-controls #csvLoadButton:hover {
            background-color: #2a9e48;
        }

        .global-controls #clearMasterTime {
            background-color: #eee;
            color: #555;
            padding: 5px 8px;
            font-size: 0.8rem;
        }
        .global-controls #clearMasterTime:hover {
            background-color: #ddd;
        }

        /* --- ì½”íŠ¸ ë ˆì´ì•„ì›ƒ --- */
        .courts-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .court {
            position: relative;
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 5px;
            background-color: #333;
            border: 12px solid #e0e0e0;
            border-radius: 5px;
            padding: 5px;
        }

        .court-number {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            background-color: #333;
            color: white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            font-weight: bold;
            z-index: 10;
            pointer-events: none;
        }

        .player-slot {
            background-color: #f0f0f0;
            color: #aaa;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 80px;
            font-size: 0.9rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.1s;
            user-select: none;
            z-index: 1;
            border: 2px dashed transparent; /* [ì‹ ê·œ] ë“œë˜ê·¸ íš¨ê³¼ìš© */
        }

        .player-slot.filled {
            background-color: #fbc2c2;
            color: #c93a3a;
            font-weight: bold;
        }
        
        /* --- [ì‹ ê·œ] ë“œë˜ê·¸ ì•¤ ë“œë¡­ ìŠ¤íƒ€ì¼ --- */
        .player-slot.drag-over {
            /* ë¹ˆ ìŠ¬ë¡¯ ìœ„ë¡œ ë“œë˜ê·¸ ì‹œ íš¨ê³¼ */
            background-color: #d4ffd4;
            border-color: #34c759;
            transform: scale(1.03);
        }
        
        .wait-item.dragging {
            /* ë“œë˜ê·¸ ì¤‘ì¸ ëŒ€ê¸°ì í•­ëª© */
            opacity: 0.4;
            transform: scale(0.95);
        }
        /* --- ë“œë˜ê·¸ ì•¤ ë“œë¡­ ë --- */


        /* --- ëŒ€ê¸° ëª…ë‹¨ --- */
        .waitlist-section {
            background-color: #f2e8e8;
            padding: 20px;
            border-radius: 10px;
        }
        .waitlist-section h3 { margin: 0 0 20px 0; font-size: 1.5rem; color: #333; }
        .add-player-form { display: flex; gap: 10px; margin-bottom: 20px; }
        .add-player-form input[type="text"] { flex-grow: 1; padding: 10px; border: 1px solid #ccc; border-radius: 5px; font-size: 1rem; }
        .add-player-form button { padding: 10px 20px; background-color: #5a8d5a; color: white; border: none; border-radius: 5px; font-size: 1rem; font-weight: bold; cursor: pointer; }
        .add-player-form button:hover { background-color: #4a744a; }

        .waiting-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 10px;
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .wait-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #fdf6f6;
            padding: 10px 15px;
            border-radius: 5px;
            border: 1px solid #e0c8c8;
            cursor: grab; /* [ì‹ ê·œ] ë“œë˜ê·¸ ê°€ëŠ¥ í‘œì‹œ */
            transition: opacity 0.2s, transform 0.2s;
        }
        .wait-item:active { cursor: grabbing; } /* [ì‹ ê·œ] ë“œë˜ê·¸ ì¤‘ í‘œì‹œ */
        .wait-item .player-name { font-weight: bold; font-size: 1.1rem; color: #333; }
        .wait-item .wait-time { background: #eee; padding: 5px 8px; border-radius: 3px; font-size: 0.9rem; font-weight: bold; color: #555; min-width: 60px; text-align: right; }
        .wait-item .assign-btn { padding: 5px 10px; font-size: 0.8rem; background-color: #4a76c2; color: white; border: none; border-radius: 3px; cursor: pointer; margin-left: 5px; }
        .wait-item .assign-btn:hover { background-color: #3a5d9a; }
    </style>
</head>
<body>

    <div class="container">
        
        <div class="global-controls">
            <div class="control-group">
                <button id="addCourtButton">â• ì½”íŠ¸ ì¶”ê°€</button>
            </div>
            
            <div class="control-group">
                <input type="file" id="csvFileInput" accept=".csv, text/csv">
                <button id="csvLoadButton" onclick="document.getElementById('csvFileInput').click();">
                    ğŸ“„ CSV ëª…ë‹¨ ë¶ˆëŸ¬ì˜¤ê¸°
                </button>
            </div>

            <div class="control-group time-control">
                <label for="masterStartTime">ëŒ€í‘œ ì‹œì‘ ì‹œê°„:</label>
                <input type="time" id="masterStartTime">
                <button id="clearMasterTime" title="ëŒ€í‘œ ì‹œì‘ ì‹œê°„ ì§€ìš°ê¸°">âŒ</button>
            </div>
        </div>

        <div class="courts-container" id="courtsContainer">
            </div>
        
        <div class="waitlist-section">
            <h3>ëŒ€ê¸° ëª…ë‹¨ & ëŒ€ê¸° ì‹œê°„ í‘œì‹œ</h3>
            
            <div class="add-player-form">
                <input type="text" id="playerNameInput" placeholder="ëŒ€ê¸°ì ì´ë¦„ ì…ë ¥...">
                <button id="addPlayerButton">ëŒ€ê¸°ì—´ ì¶”ê°€</button>
            </div>
            
            <ul class="waiting-list" id="waitingList">
                </ul>
        </div>

    </div>

    <script>
        // --- JavaScript (ì• í”Œë¦¬ì¼€ì´ì…˜ ë™ì‘ ë¡œì§) ---

        // 1. í•„ìš”í•œ HTML ìš”ì†Œë“¤ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
        const playerNameInput = document.getElementById('playerNameInput');
        const addPlayerButton = document.getElementById('addPlayerButton');
        const waitingListElement = document.getElementById('waitingList');
        const courtsContainer = document.getElementById('courtsContainer');
        
        const addCourtButton = document.getElementById('addCourtButton');
        const masterStartTimeInput = document.getElementById('masterStartTime');
        const clearMasterTimeButton = document.getElementById('clearMasterTime');
        
        // [ì‹ ê·œ] CSV íŒŒì¼ ì…ë ¥
        const csvFileInput = document.getElementById('csvFileInput');

        // 2. ë°ì´í„° ë³€ìˆ˜
        let waitingQueue = [];
        let nextId = 0;
        let courtCount = 0; // [ìˆ˜ì •] 0ì—ì„œ ì‹œì‘í•´ì„œ addCourtë¡œ ìƒì„±

        // 3. (í•¨ìˆ˜) ëŒ€ê¸°ì—´ ëª©ë¡ì„ í™”ë©´ì— ë Œë”ë§ (ì—…ë°ì´íŠ¸)
        function renderWaitingList() {
            waitingListElement.innerHTML = '';
            const now = Date.now();

            waitingQueue.forEach(player => {
                const elapsedSeconds = Math.floor((now - player.startTime) / 1000);
                const minutes = Math.floor(elapsedSeconds / 60);
                const seconds = elapsedSeconds % 60;
                const formattedTime = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}ì´ˆ`;

                const li = document.createElement('li');
                li.className = 'wait-item';
                
                // --- [ì‹ ê·œ] ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì†ì„± ì¶”ê°€ ---
                li.setAttribute('draggable', 'true');
                li.dataset.playerId = player.id; // [ìˆ˜ì •] ë“œë˜ê·¸ ì‹œì‘ ì‹œ IDë¥¼ ì•Œê¸° ìœ„í•´ data ì†ì„± ì‚¬ìš©
                
                li.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', player.id);
                    e.dataTransfer.effectAllowed = 'move';
                    // [ìˆ˜ì •] e.target ëŒ€ì‹  ëª…í™•í•˜ê²Œ liì— í´ë˜ìŠ¤ ì¶”ê°€
                    li.classList.add('dragging'); 
                });
                
                li.addEventListener('dragend', () => {
                    li.classList.remove('dragging');
                });
                // --- ë“œë˜ê·¸ ì•¤ ë“œë¡­ ë ---

                li.innerHTML = `
                    <span class="player-name">${player.name}</span>
                    <span class="wait-time">${formattedTime}</span>
                    <button class="assign-btn" data-player-id="${player.id}">ë°°ì •</button>
                `;
                waitingListElement.appendChild(li);
            });
        }

        // 4. (í•¨ìˆ˜) ëŒ€ê¸°ì—´ì— ìƒˆ í”Œë ˆì´ì–´ ì¶”ê°€ (ì´ë¦„, ì‹œì‘ì‹œê°„)
        function addPlayerToQueue(name, startTime) {
            if (!name || name.trim() === "") return; // ë¹ˆ ì´ë¦„ì€ ì¶”ê°€í•˜ì§€ ì•ŠìŒ

            const newPlayer = {
                id: nextId++,
                name: name.trim(),
                startTime: startTime
            };
            waitingQueue.push(newPlayer);
        }
        
        // 4-1. (í•¨ìˆ˜) 'ëŒ€ê¸°ì—´ ì¶”ê°€' ë²„íŠ¼ í´ë¦­ ì‹œ ì‹¤í–‰
        function handleAddPlayerButton() {
            const name = playerNameInput.value;
            if (name.trim() === "") {
                alert("í”Œë ˆì´ì–´ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”!");
                return;
            }

            // ëŒ€í‘œ ì‹œì‘ ì‹œê°„ í™•ì¸ ë¡œì§
            let startTime = Date.now(); 
            const masterTimeValue = masterStartTimeInput.value;
            if (masterTimeValue) {
                const [hours, minutes] = masterTimeValue.split(':').map(Number);
                const manualStartTime = new Date();
                manualStartTime.setHours(hours, minutes, 0, 0);
                
                if (manualStartTime.getTime() > Date.now()) {
                    alert("ëŒ€í‘œ ì‹œì‘ ì‹œê°„ì€ í˜„ì¬ ì‹œê°„ë³´ë‹¤ ë¯¸ë˜ì¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                    return;
                }
                startTime = manualStartTime.getTime();
            }
            
            addPlayerToQueue(name, startTime); // ê³µí†µ í•¨ìˆ˜ í˜¸ì¶œ
            playerNameInput.value = ''; // ì…ë ¥ì°½ ë¹„ìš°ê¸°
            renderWaitingList(); // í™”ë©´ ê°±ì‹ 
        }

        // 5. [ìˆ˜ì •] (í•¨ìˆ˜) í”Œë ˆì´ì–´ë¥¼ ìŠ¬ë¡¯ì— ë°°ì • (í•µì‹¬ ë¡œì§ í†µí•©)
        function assignPlayerById(playerId, targetSlot) {
            // 1. ëŒ€ê¸°ì—´ì—ì„œ í”Œë ˆì´ì–´ ì°¾ê¸°
            const playerIndex = waitingQueue.findIndex(p => p.id == playerId);
            if (playerIndex === -1) return; // ëŒ€ê¸°ì—´ì— ì—†ëŠ” í”Œë ˆì´ì–´ (ì´ë¯¸ ë°°ì •ë¨)

            const player = waitingQueue[playerIndex];

            // 2. targetSlotì´ ì£¼ì–´ì¡ŒëŠ”ì§€ (ë“œë˜ê·¸) í™•ì¸, ì—†ìœ¼ë©´ (ë²„íŠ¼ í´ë¦­) ë¹ˆ ìŠ¬ë¡¯ ì°¾ê¸°
            let slotToFill = targetSlot;
            
            if (!slotToFill) { // ë²„íŠ¼ í´ë¦­ ì‹œ
                const allSlots = document.querySelectorAll('.player-slot');
                for (const slot of allSlots) {
                    if (!slot.classList.contains('filled')) {
                        slotToFill = slot;
                        break;
                    }
                }
            }
            
            // 3. ë¹ˆ ìŠ¬ë¡¯ì´ ìˆëŠ”ì§€ ìµœì¢… í™•ì¸
            if (!slotToFill) {
                alert("ëª¨ë“  ì½”íŠ¸ê°€ ê½‰ ì°¼ìŠµë‹ˆë‹¤!");
                return;
            }
            
            // [ìˆ˜ì •] ì´ë¯¸ ì±„ì›Œì§„ ìŠ¬ë¡¯ì— ë“œë¡­í•˜ëŠ” ê²ƒ ë°©ì§€
            if (slotToFill.classList.contains('filled')) {
                alert("ì´ë¯¸ í”Œë ˆì´ì–´ê°€ ë°°ì •ëœ ìŠ¬ë¡¯ì…ë‹ˆë‹¤.");
                return;
            }

            // 4. ìŠ¬ë¡¯ ì±„ìš°ê¸°
            slotToFill.classList.add('filled');
            slotToFill.textContent = player.name;
            slotToFill.dataset.playerName = player.name; 

            // 5. ëŒ€ê¸°ì—´ì—ì„œ ì œê±° ë° í™”ë©´ ê°±ì‹ 
            waitingQueue.splice(playerIndex, 1);
            renderWaitingList();
        }
        
        // 6. (í•¨ìˆ˜) ì½”íŠ¸ ìŠ¬ë¡¯ ë¹„ìš°ê¸° (í´ë¦­ ì‹œ)
        function clearSlot(event) {
            const slot = event.target; 
            if (slot.classList.contains('filled')) {
                const playerName = slot.dataset.playerName;
                if (confirm(`'${playerName}'ë‹˜ì˜ ë°°ì •ì„ ì·¨ì†Œí•˜ê³  ëŒ€ê¸°ì—´ë¡œ ëŒë ¤ë³´ë‚´ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                    addPlayerToQueue(playerName, Date.now()); // ëŒ€ê¸°ì—´ ë§¨ ë’¤ë¡œ ë‹¤ì‹œ ì¶”ê°€
                    
                    slot.classList.remove('filled');
                    slot.textContent = `í”Œë ˆì´ì–´ ${slot.dataset.slot}`;
                    delete slot.dataset.playerName;
                    
                    renderWaitingList(); 
                }
            }
        }

        // 7. (í•¨ìˆ˜) ìƒˆ ì½”íŠ¸ ì¶”ê°€
        function addCourt() {
            courtCount++;
            const newCourt = document.createElement('div');
            newCourt.className = 'court';
            newCourt.id = `court-${courtCount}`;
            newCourt.innerHTML = `
                <span class="court-number">${courtCount}</span>
                <div class="player-slot" data-court="${courtCount}" data-slot="1">í”Œë ˆì´ì–´ 1</div>
                <div class="player-slot" data-court="${courtCount}" data-slot="2">í”Œë ˆì´ì–´ 2</div>
                <div class="player-slot" data-court="${courtCount}" data-slot="3">í”Œë ˆì´ì–´ 3</div>
                <div class="player-slot" data-court="${courtCount}" data-slot="4">í”Œë ˆì´ì–´ 4</div>
            `;
            courtsContainer.appendChild(newCourt);
        }
        
        // 8. [ì‹ ê·œ] (í•¨ìˆ˜) CSV íŒŒì¼ ì½ê¸°
        function handleCsvUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            
            reader.onload = (e) => {
                const text = e.target.result;
                const lines = text.split('\n'); // íŒŒì¼ ë‚´ìš©ì„ ì¤„ë°”ê¿ˆ ê¸°ì¤€ìœ¼ë¡œ ë‚˜ëˆ”
                
                const startTime = Date.now(); // íŒŒì¼ ì—…ë¡œë“œ ì‹œì ì˜ ì‹œê°„
                let addedCount = 0;

                lines.forEach(line => {
                    const name = line.trim(); // ê° ì¤„ì˜ ì´ë¦„ (ê³µë°± ì œê±°)
                    if (name) { // ë¹ˆ ì¤„ì´ ì•„ë‹ˆë©´
                        addPlayerToQueue(name, startTime); // ëŒ€ê¸°ì—´ì— ì¶”ê°€
                        addedCount++;
                    }
                });
                
                renderWaitingList(); // ì „ì²´ ëŒ€ê¸°ì—´ ê°±ì‹ 
                alert(`${addedCount}ëª…ì˜ í”Œë ˆì´ì–´ê°€ ëŒ€ê¸°ì—´ì— ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                
                // [ì¤‘ìš”] input ê°’ì„ ë¹„ì›Œì•¼ ê°™ì€ íŒŒì¼ì„ ë‹¤ì‹œ ì˜¬ë ¤ë„ 'change' ì´ë²¤íŠ¸ê°€ ë°œìƒí•¨
                csvFileInput.value = ''; 
            };
            
            reader.onerror = () => {
                alert("íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            };

            reader.readAsText(file); // íŒŒì¼ì„ í…ìŠ¤íŠ¸ë¡œ ì½ê¸° ì‹œì‘
        }

        // --- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²° ---

        // 'ëŒ€ê¸°ì—´ ì¶”ê°€' ë²„íŠ¼
        addPlayerButton.addEventListener('click', handleAddPlayerButton);
        playerNameInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') handleAddPlayerButton();
        });

        // 'ì½”íŠ¸ ì¶”ê°€' ë²„íŠ¼
        addCourtButton.addEventListener('click', addCourt);
        
        // 'ëŒ€í‘œ ì‹œê°„ ì§€ìš°ê¸°' ë²„íŠ¼
        clearMasterTimeButton.addEventListener('click', () => {
            masterStartTimeInput.value = '';
        });
        
        // [ì‹ ê·œ] CSV íŒŒì¼ ì„ íƒ(change) ì´ë²¤íŠ¸
        csvFileInput.addEventListener('change', handleCsvUpload);

        // 'ë°°ì •' ë²„íŠ¼ í´ë¦­ (ì´ë²¤íŠ¸ ìœ„ì„)
        waitingListElement.addEventListener('click', (e) => {
            if (e.target.classList.contains('assign-btn')) {
                const playerId = e.target.dataset.playerId;
                assignPlayerById(playerId, null); // targetSlotì„ nullë¡œ ì „ë‹¬
            }
        });
        
        // ì½”íŠ¸ ìŠ¬ë¡¯ í´ë¦­ (ë°°ì • ì·¨ì†Œ) (ì´ë²¤íŠ¸ ìœ„ì„)
        courtsContainer.addEventListener('click', (e) => {
            if (e.target.classList.contains('player-slot')) {
                clearSlot(e);
            }
        });

        // --- [ì‹ ê·œ] ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ (ì´ë²¤íŠ¸ ìœ„ì„) ---
        
        // 1. ë“œë˜ê·¸ê°€ ìŠ¬ë¡¯ ìœ„ë¡œ ì˜¬ë¼ì™”ì„ ë•Œ
        courtsContainer.addEventListener('dragover', (e) => {
            e.preventDefault(); // [í•„ìˆ˜] 'drop' ì´ë²¤íŠ¸ë¥¼ í—ˆìš©í•˜ê¸° ìœ„í•´ ê¸°ë³¸ ë™ì‘ ë°©ì§€
            const targetSlot = e.target;
            // ë¹ˆ ìŠ¬ë¡¯ ìœ„ì—ì„œë§Œ + ë“œë˜ê·¸ íš¨ê³¼ ì£¼ê¸°
            if (targetSlot.classList.contains('player-slot') && !targetSlot.classList.contains('filled')) {
                targetSlot.classList.add('drag-over');
                e.dataTransfer.dropEffect = 'move';
            } else {
                e.dataTransfer.dropEffect = 'none';
            }
        });
        
        // 2. ë“œë˜ê·¸ê°€ ìŠ¬ë¡¯ì„ ë²—ì–´ë‚¬ì„ ë•Œ
        courtsContainer.addEventListener('dragleave', (e) => {
            if (e.target.classList.contains('player-slot')) {
                e.target.classList.remove('drag-over'); // ë“œë˜ê·¸ íš¨ê³¼ ì œê±°
            }
        });
        
        // 3. ë“œë¡­(ë†“ê¸°)ì´ ë°œìƒí–ˆì„ ë•Œ
        courtsContainer.addEventListener('drop', (e) => {
            e.preventDefault();
            const targetSlot = e.target;
            targetSlot.classList.remove('drag-over'); // ë“œë˜ê·¸ íš¨ê³¼ ì œê±°
            
            // ë¹ˆ ìŠ¬ë¡¯ì—ë§Œ ë“œë¡­ ê°€ëŠ¥
            if (targetSlot.classList.contains('player-slot') && !targetSlot.classList.contains('filled')) {
                const playerId = e.dataTransfer.getData('text/plain');
                assignPlayerById(playerId, targetSlot); // targetSlotì„ ëª…ì‹œ
            }
        });

        // --- [ìˆ˜ì •] ì´ˆê¸°í™” í•¨ìˆ˜ ---
        function initializeApp() {
            // ì´ˆê¸° 4ê°œ ì½”íŠ¸ ìƒì„±
            for (let i = 0; i < 4; i++) {
                addCourt();
            }
            
            // ì´ˆê¸° ì˜ˆì‹œ ë°ì´í„°
            waitingQueue = [
                { id: nextId++, name: 'ë°•ì„±ì¤€', startTime: Date.now() - 10000 },
                { id: nextId++, name: 'ê°•ì¤€ì‹œ', startTime: Date.now() - 20000 },
                { id: nextId++, name: 'ê³ ë„í•œ', startTime: Date.now() - 30000 },
                { id: nextId++, name: 'ë°í¬ë„ˆ', startTime: Date.now() - 10000},
                { id: nextId++, name: 'ë‹¤ì´ì¦ˆ', startTime: Date.now() - 10000 },
            ];
            renderWaitingList();
        }

        // 1ì´ˆë§ˆë‹¤ íƒ€ì´ë¨¸ ê°±ì‹ 
        setInterval(renderWaitingList, 1000);
        
        // ì•± ì‹¤í–‰
        initializeApp();

    </script>
</body>
</html>
